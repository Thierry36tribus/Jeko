"use strict";function TimeMachine(e,t,a,n){var i,r=function(){e.tmPlaying=!1,angular.isDefined(i)&&(t.cancel(i),i=void 0)};e.$on("$destroy",function(){r()}),e.previousWeek=function(){e.week>e.firstWeek&&e.week--},e.nextWeek=function(){e.week<e.lastWeek&&e.week++},e.play=function(){e.tmPlaying=!e.tmPlaying,e.tmPlaying?(e.week==e.lastWeek&&(e.week=e.firstWeek),i=t(function(){e.nextWeek(),e.week==e.lastWeek&&(e.tmPlaying=!1)},PLAY_DELAY,n())):i&&r()},e.$watch("week",function(t,n){t&&t!=n&&(e.firstWeekFromDate=TimeMachine.getDateOfWeekIndex(e.firstWeek),e.fromDate=TimeMachine.getDateOfWeekIndex(t),e.toDate=e.fromDate.addDays(6),a())})}var PLAY_DELAY=200;Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},TimeMachine.getDateOfWeekIndex=function(e){var t=TimeMachine.firstWeek+1*e-1,a=TimeMachine.firstYear;t>TimeMachine.lastWeekOfYear&&(t-=TimeMachine.lastWeekOfYear,a++);var n=TimeMachine.getDateOfWeek(a,t);return n},TimeMachine.getDateOfWeek=function(e,t){var a=new Date(e,0,1+7*(t-1)),n=a.getDay(),i=a;return 4>=n?i.setDate(a.getDate()-a.getDay()+1):i.setDate(a.getDate()+8-a.getDay()),i},TimeMachine.prototype.animate=function(e,t){TimeMachine.doAnimation()&&t(function(){e.nextWeek()},5*PLAY_DELAY,1)},TimeMachine.doAnimation=function(){return!1};