"use strict";function Orchard(r){r.sort(Tree.compareBottom),this.trees=r;var e=angular.element("#orchardCanvas"),a=e.width(),t=e.height();this.scale=function(){var r=1220,e=600,i=a/r,o=t/e,n=Math.min(i,o);t>a&&400>t&&(n=.7*o),paper.view.zoom=n,Orchard.adjust=new paper.Point(paper.project.activeLayer.position.x-paper.view.center.x,paper.project.activeLayer.position.y-paper.view.center.y),paper.project.activeLayer.position.x=paper.view.center.x,paper.project.activeLayer.position.y=paper.view.center.y+Orchard.Y_OFFSET},r[0].dwelling.savings[r[0].dwelling.savings.length-1]}Orchard.setup=function(r){paper.setup("orchardCanvas");var e=angular.element("#orchardCanvas"),a=e.width(),t=e.height();Orchard.treesCenter=Orchard.POSITION_CENTER,Orchard.treesPositions=Orchard.POSITIONS,t>a&&400>t&&(Orchard.xs=!0,Orchard.treesCenter=Orchard.XS_POSITION_CENTER,Orchard.treesPositions=Orchard.XS_POSITIONS,Orchard.Y_OFFSET=0),Tree.preload(r)},Orchard.Y_OFFSET=20,Orchard.POSITION_CENTER={x:540,y:190},Orchard.XS_POSITION_CENTER={x:250,y:150},Orchard.POSITIONS=[{x:20,y:170},{x:80,y:50},{x:150,y:240},{x:210,y:100},{x:350,y:60},{x:360,y:200},{x:670,y:100},{x:690,y:270},{x:790,y:190},{x:870,y:75},{x:930,y:200},{x:1050,y:150}],Orchard.XS_POSITIONS=[{x:0,y:30},{x:140,y:0},{x:340,y:40},{x:500,y:0},{x:0,y:120},{x:490,y:120},{x:130,y:320},{x:0,y:280},{x:110,y:170},{x:330,y:320},{x:390,y:190},{x:500,y:340}],Orchard.prototype.draw=function(){var r=this;paper.project.activeLayer.removeChildren(),r.trees.forEach(function(r){r.draw()}),this.scale(),paper.view.draw(),this.drawn=!0},Orchard.prototype.drawFruits=function(){if(this.drawn){var r=this;r.trees.forEach(function(r){r.drawFruits()}),paper.view.draw()}},Orchard.prototype.drawElement=function(r){var e=this;r.image.endsWith(".svg")&&paper.project.importSVG("img/shop/"+r.image,function(a){var t=r.x,i=r.y;"balloon.svg"!=r.image||Orchard.xs||(i=50),Orchard.xs&&(t/=2,i=1.2*i),t-=Orchard.adjust.x,i-=Orchard.adjust.y,a.position=new paper.Point(t,i),e.animateDecor(r,a)})},Orchard.prototype.drawDecor=function(r){var e=this;r&&r.forEach(function(r){e.drawElement(r)})},Orchard.prototype.animateDecor=function(r,e){if(0==r.image.indexOf("snail"))e.onFrame=function(r){0==r.count%6&&(e.position.x=e.position.x+1),e.position.x>Orchard.treesPositions[Orchard.treesPositions.length-1].x&&(e.position.x=0)};else if("balloon.svg"==r.image&&!Orchard.xs){var a=e.scaling,t=e.position;e.onFrame=function(){e.scale(.99),e.position.x+=.15,e.position.y-=1,e.scaling.x<.1&&(e.scaling=a,e.position=t)}}};