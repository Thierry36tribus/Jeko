"use strict";function MyConsQuizz(e,t){this.id=Games.MyConsQuizz.gameDesc.id,this.title=Games.MyConsQuizz.gameDesc.title,this.desc=Games.MyConsQuizz.gameDesc,this.$scope=e,this.onGameEnded=t}function MyChart(e,t){this.id=Games.MyChart.gameDesc.id,this.title=Games.MyChart.gameDesc.title,this.desc=Games.MyChart.gameDesc,this.$scope=e,this.onGameEnded=t}function JekoQuizz(e,t){this.id=Games.JekoQuizz.gameDesc.id,this.title=Games.JekoQuizz.gameDesc.title,this.desc=Games.JekoQuizz.gameDesc,this.$scope=e,this.onGameEnded=t}window.Games={},Games.trim=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},Games.randomInt=function(e,t){return Math.round(Math.random()*(t-e)+e)},Games.shuffle=function(e){for(var t,s,a=e.length;a;)s=Math.floor(Math.random()*a--),t=e[a],e[a]=e[s],e[s]=t;return e},Games.MyConsQuizz={},Games.MyConsQuizz.init=function(e){Games.MyConsQuizz.gameDesc=e,Games.MyConsQuizz.reset()},Games.MyConsQuizz.reset=function(){Games.MyConsQuizz.questions=Games.MyConsQuizz.buildQuestions(Games.MyConsQuizz.gameDesc.data),Games.MyConsQuizz.questionIndex=-1},Games.MyConsQuizz.buildQuestions=function(e){var t=[],s=function(e,t){for(var s,a=0;1e3>a&&(s=Games.randomInt(e/2,2*e),!(e-t>s||s>e+t));a++);return s>100?100*Math.round(s/100):s},a=function(e){var t=Math.round(e.waterCons),a=s(t,500),n=100*Games.randomInt(1,5),o={text:"La semaine dernière, ma consommation d'eau a été de :",answers:[{good:!0,text:t+" litres"},{text:a+" litres"},{text:n+" litres"}]};return Games.shuffle(o.answers),o},n=function(e){var t=100*Math.round(e.electricityCons),a=s(t,1e3),n=100*Games.randomInt(1,5),o={text:"Avec ma consommation d'électricité de cette semaine, en vélo à assistance électrique j'aurais pu parcourir : ",answers:[{good:!0,text:t+" kms"},{text:a+" kms"},{text:n+" kms"}]};return Games.shuffle(o.answers),o},o=function(e,t){var s={text:"Par rapport à la semaine d'avant, ma consommation "+t.text+" a été :",answers:[{text:"Plus élevée"},{text:"Moins élevée"},{text:"A peu près identique"}]};return t.value<-.1?s.answers[0].good=!0:t.value>.1?s.answers[1].good=!0:s.answers[2].good=!0,Games.shuffle(s.answers),s},i=function(e){var t=Math.round(e.waterCons/1.5),a=s(t,400),n=100*Games.randomInt(1,5),o={text:"La semaine dernière, j'ai consommé l'équivalent de :",answers:[{good:!0,text:t+" bouteilles d'eau"},{text:a+" bouteilles d'eau"},{text:n+" bouteilles d'eau"}]};return Games.shuffle(o.answers),o},u=function(e,t){var s={text:"Par rapport à la moyenne des autres locataires, la semaine dernière ma consommation "+t.text+" a été :",answers:[{text:"Plus élevée"},{text:"Moins élevée"},{text:"A peu près identique"}]};return 1.1*t.value>t.mean?s.answers[0].good=!0:.9*t.value<t.mean?s.answers[1].good=!0:s.answers[2].good=!0,Games.shuffle(s.answers),s},r=function(e){var t=e.surface*Math.round(e.heatingCons+e.hotWaterCons)/10,a=s(t,50),n=10*Games.randomInt(1,5),o={text:"Si j'utilisais une chaudière au fioul pour me chauffer, j'aurais consommé combien de litres cette semaine ?",answers:[{good:!0,text:t+" litres"},{text:a+" litres"},{text:n+" litres"}]};return Games.shuffle(o.answers),o},m=function(e){var t=e.heatingCons*e.surface,a=Math.round(75*t/1800),n=s(a,50),o=10*Games.randomInt(1,5),i={text:"Si j'utilisais un poêle à bois pour me chauffer, j'aurais consommé combien de buches de bois (30 cm x 20 cm) cette semaine ?",answers:[{good:!0,text:a+" buches"},{text:n+" buches"},{text:o+" buches"}]};return Games.shuffle(i.answers),i},c=function(e){var t=(e.heatingCons+e.hotWaterCons)*e.surface,a=Math.round(.238*t),n=s(a,50),o=10*Games.randomInt(1,5),i={text:"Combien de kilos de CO2 ma consommation de gaz de cette semaine a t-elle dégagé ?",answers:[{good:!0,text:a+" kg"},{text:n+" kg"},{text:o+" kg"}]};return Games.shuffle(i.answers),i};t.push(a(e)),t.push(n(e));var d=[{text:"d'électricité",value:e.electricity},{text:"d'eau",value:e.water},{text:"d'eau chaude",value:e.hotWater}];d.forEach(function(s){t.push(o(e,s))}),t.push(i(e));var h=[{text:"d'électricité",value:e.electricityCons,mean:e.electricityConsMean},{text:"d'eau",value:e.waterCons,mean:e.waterConsMean},{text:"d'eau chaude",value:e.hotWaterCons,mean:e.hotWaterConsMean}];return e.heatingCons>0&&h.push({text:"de chauffage",value:e.heatingCons,mean:e.heatingConsMean}),h.forEach(function(s){t.push(u(e,s))}),e.heatingCons>0&&(t.push(r(e)),t.push(m(e))),t.push(c(e)),Games.shuffle(t),t},MyConsQuizz.prototype.start=function(){Games.MyConsQuizz.questionIndex++;var e=this,t=this.$scope;t.withoutTitle=matchMediaPhone(),t.$parent.withoutPoints=t.withoutTitle,t.question=Games.MyConsQuizz.questions[Games.MyConsQuizz.questionIndex];var s=function(e){var t="Oups...";return e.answers.forEach(function(e){e.good&&(t=e.text)}),t};t.selectAnswer=function(a){t.question.answered||(a.selected=!0,t.question.answered=!0,e.win=a.good,e.resultInfo="",e.winText="Bonne réponse !",e.lostText="La réponse correcte était : '"+s(t.question)+"'",e.ended=!0,e.onGameEnded())}},Games.MyChart={},Games.MyChart.init=function(e){Games.MyChart.gameDesc=e,Games.MyChart.reset()},Games.MyChart.reset=function(){Games.MyChart.questions=Games.MyChart.buildQuestions(Games.MyChart.gameDesc.data),Games.MyChart.questionIndex=-1},Games.MyChart.buildDataChart=function(e,t){var s=[];return e.savings.forEach(function(e){s.push({week:e.week,value:e[t]})}),s.reverse(),s},Games.MyChart.buildQuestion=function(e,t,s){var a=this.buildDataChart(e[0],t),n=this.buildDataChart(e[1],t),o=this.buildDataChart(e[2],t),i={text:"Laquelle de ces courbes est celle de votre consommation "+s+" semaine après semaine ?",answers:[{good:!0,data:a},{data:n},{data:o}]};return Games.shuffle(i.answers),i},Games.MyChart.buildQuestions=function(e){var t=[];return t.push(this.buildQuestion(e,"waterCons","d'eau")),t.push(this.buildQuestion(e,"electricityCons","d'électricité")),t.push(this.buildQuestion(e,"hotWaterCons","d'eau chaude")),Games.shuffle(t),t},MyChart.prototype.start=function(){Games.MyChart.questionIndex++;var e=this,t=this.$scope;t.withoutTitle=matchMediaPhone(),t.$parent.withoutPoints=t.withoutTitle,t.question=Games.MyChart.questions[Games.MyChart.questionIndex];var s=function(e){var t;return e.answers.forEach(function(e,s){e.good&&(t=s+1)}),t};t.selectAnswer=function(a){t.question.answered||(a.selected=!0,t.question.answered=!0,e.win=a.good,e.resultInfo="",e.winText="Bonne réponse !",e.lostText="La réponse correcte était : 'la courbe n° "+s(t.question)+"'",e.ended=!0,e.onGameEnded())}},Games.JekoQuizz={},Games.JekoQuizz.init=function(e){Games.JekoQuizz.gameDesc=e,Games.JekoQuizz.reset()},Games.JekoQuizz.reset=function(){Games.JekoQuizz.questions=Games.JekoQuizz.buildQuestions(Games.JekoQuizz.gameDesc.data),Games.JekoQuizz.questionIndex=-1},Games.JekoQuizz.buildQuestions=function(e){var t=[],s=function(e){var t={text:e.question,answers:[{good:!0,text:e.goodAnswer},{text:e.answer2},{text:e.answer3},{text:e.answer4}]};return Games.shuffle(t.answers),t};Games.shuffle(e);for(var a=0;6>a;a++)t.push(s(e[a]));return Games.shuffle(t),t},JekoQuizz.prototype.start=function(){Games.JekoQuizz.questionIndex++;var e=this,t=this.$scope;t.withoutTitle=matchMediaPhone(),t.$parent.withoutPoints=t.withoutTitle,t.question=Games.JekoQuizz.questions[Games.JekoQuizz.questionIndex];var s=function(e){var t="Oups...";return e.answers.forEach(function(e){e.good&&(t=e.text)}),t};t.selectAnswer=function(a){t.question.answered||(a.selected=!0,t.question.answered=!0,e.win=a.good,e.resultInfo="",e.winText="Bonne réponse !",e.lostText="La réponse correcte était : '"+s(t.question)+"'",e.ended=!0,e.onGameEnded())}};